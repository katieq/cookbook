{% extends 'cooklog/__base.html' %}
{% load static %}
{% block body_block %}
<div class="page-title">
    lastest feeds
</div>

<div class="page-menu">
    [
    <a href="/cooklog/album/">album view</a> |
    <a href="/cooklog/ingredients/album/">ingredients album</a> |
    <a href="/cooklog/ingredients/">ingredients list</a> |
    <a href="/cooklog/recipes/">recipe list</a>]
</div>



<div class="dev">
    {% for chef in followed_chefs.all %}
    <p> this user {{chef.follower_id }} follows {{ chef.chef_id }} </p>
    {% endfor %}


{% for chef in chefs %}
<p> this user {{chef.follower_id }} follows this chef {{ chef.chef_id }} </p>
{% endfor %}
</div>

{% for dish in latest_dishs %}

{% comment %}
<div class="dish-mini">
<div class="dish-mini-image">
    
    {% if dish.dish_image %}
    <div class="crop">
        <a href="dish/{{dish.dish_id}}/"><img src="/media/{{ dish.dish_image }}" /></a>
    </div>
    {% else %}
    <div class="crop-placeholder">
        <a href="dish/{{dish.dish_id}}/"><img src="{% static "emoji/img/yum.png" %}" alt="My image"/></a>
    </div>
    {% endif %}
</div>
<div class="dish-mini-inner">
<div class="dish-mini-inner-name">
    <a href="dish/{{dish.dish_id}}/">{{ dish.dish_name }}</a>
</div>
<div class="dish-mini-inner-rating">
    {% if dish.dish_rating %}
    {% for i in "x"|rjust:dish.dish_rating %}
    <img src="{% static "emoji/img/star.png" %}" alt="star" height="15"/>
    {% endfor %}
    {% endif %}
</div>
</div>
</div>
{% endcomment %}

    <div class="dish-mini">
        <div class="dish-mini-image-column">
        {% if dish.dish_image %}
        <div class="crop-image">
            <a href="dish/{{dish.dish_id}}/"><img src="/media/{{ dish.dish_image }}" /></a>
        </div>
        {% else %}
        <div class="crop-placeholder">
            <a href="/cooklog/dish/{{dish.dish_id}}/"><img class="fa fa-plus"></a>
            {% comment %}
            <a href="dish/{{dish.dish_id}}/"><img src="{% static "emoji/img/yum.png" %}" alt="My image"/></a>
            {% endcomment %}
        </div>
        {% endif %}
        </div>
        
        <div class="dish-mini-text-column">
            <div class="dish-mini-date-inline">
                {{ dish.date_created|date:"D M.d"|lower }}
            </div> |
            <div class="dish-mini-dish-chef-name">
                <a href="/cooklog/chef/{{dish.chef_id_id}}/">{{ dish.chef_id.first_name }}</a>
            </div> |
            <div class="dish-mini-recipe-icon">
                {% ifequal user.id dish.chef_id_id %}
                <a href="/cooklog/dish/add/{{dish.dish_id}}/"><i class="fa fa-pencil"></i></a>
                {% endifequal %}
            </div> |
            <div class="dish-mini-recipe-icon">
                {% ifequal dish.recipe_id_id 1 %}
                <a href="/cooklog/dish/{{dish.dish_id}}/"><i class="fa fa-question fa-lg"></i></a>
                {% else %}
                <a href="/cooklog/recipe/{{dish.recipe_id_id}}/"><img src="{% static "emoji/img/chef.png" %}" height="14"/></a>
                {% endifequal %}
            </div> |
            <div class="dish-mini-stars">
                {% if dish.dish_rating %}
                {% for i in "x"|rjust:dish.dish_rating %}
                <i class="fa fa-star"></i>
                {% comment %}
                <img src="{% static "emoji/img/star.png" %}" alt="star" height="10"/>
                {% endcomment %}
                {% endfor %}
                {% endif %}
            </div>
            
            <div class="dish-mini-dish-name">
                <a href="/cooklog/dish/{{dish.dish_id}}/">{{ dish.dish_name }}</a>
            </div>
            
            <div class="dish-mini-social-comments-and-likes">
                
                <div class="dish-mini-comments" >
                    {% for chef_comment in chef_comments %}
                    {% ifequal chef_comment.dish_id_id dish.dish_id %}
                        <a href="/cooklog/chef/{{chef_comment.chef_id_id}}/">{{ chef_comment.chef_id.first_name }}</a> <i> says </i> {{ chef_comment.chef_dish_comment }}
                        <a href="/cooklog/comment/delete/{{chef_comment.chef_dish_comment_id}}/">[delete]</a>
                        {% endifequal %}
                    {% endfor %}
                </div>
                
                <div class="dish-mini-button-add-comment">
                    <a href="{% url 'comment_add' %}?next={{dish.dish_id}}">[add comment]</a>
                </div>
                
                <div class="dish-mini-likes">
                    Likes: {{ dish.like_chef_id.count }}
                    {% ifequal dish.like_chef_id.count 0 %}
                    {% else %}
                    (
                    {% for chef_like in dish.like_chef_id.all %}
                    <a href="/cooklog/chef/{{chef_like.chef_id}}/">{{chef_like.first_name}}</a>,
                    {% endfor %}
                    )
                    {% endifequal %}
                    <a href="/cooklog/like/{{dish.dish_id}}/?next=0">[like it]</a>
                </div>
            </div>
            
        {% comment %}

        <div class="dish-mini-date">
        {{ dish.date_created|date:"D, M d"|upper }}
        </div>
        <div class="dish-mini-chef">
        <a href="chef/{{dish.chef_id_id}}/">{{ dish.chef_id.first_name }} {{ dish.chef_id.last_name.0}}</a>
        </div>
        <div class="dish-mini-image">
            
            
        </div>
        <div class="dish-mini-inner">
            <div class="dish-mini-inner-name">
            <a href="dish/{{dish.dish_id}}/">{{ dish.dish_name }}</a>
            </div>
            <div class="dish-mini-inner-rating">
            {% if dish.dish_rating %}
            {% for i in "x"|rjust:dish.dish_rating %}
                <i class="fa fa-star"></i>
            {% endfor %}
            {% endif %}
            </div>
            <div class="dish-mini-inner-recipe">
                {% ifequal dish.recipe_id_id 1 %}
                    <a href="dish/{{dish.dish_id}}/"><i class="fa fa-question fa-lg"></i></a>
                {% else %}
                    <a href="recipe/{{dish.recipe_id_id}}/"><img src="{% static "emoji/img/chef.png" %}" alt="master" height="18"/></a>
                {% endifequal %}
                {% ifequal user.id dish.chef_id_id %}
                    <a href="/cooklog/dish/add/{{dish.dish_id}}/"><img src="{% static "emoji/img/edit.png" %}" alt="edit" height="18"/></a>
                {% endifequal %}
                
                {% for user_likes in latest_dish_user_likes %}
                    {% ifequal dish.dish_id user_likes.dish_id_id %}
                        <img src="{% static "emoji/img/yum.png" %}" alt="yum" height="18"/>
                    {% endifequal %}
                {% endfor %}
                

            </div>
        </div>
        {% endcomment %}
        </div>
        
    </div>

{% empty %}
    <li>No dishes yet.</li>
{% endfor %}
{% endblock %}

